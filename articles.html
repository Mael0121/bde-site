<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Articles - BDE</title>
  <link rel="stylesheet" href="style.css">
  <!-- Privacy-friendly analytics by Plausible -->
  <script async src="https://plausible.io/js/pa-jUQzIwoquetz2aXjRjVbA.js"></script>
  <script>
    window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};
    plausible.init()
  </script>
</head>
<body>
  <!-- Header -->
  <header>
    <h1>BDE</h1>
    <nav>
      <ul>
        <li><a href="index.html">Accueil</a></li>
        <li><a href="articles.html">Articles</a></li>
        <li><a href="cabrinibook.html">Cabrinibook</a></li>
      </ul>
    </nav>
  </header>

  <!-- Section principale -->
  <main>
    <section class="articles">
      <h2>Tous les articles</h2>
      <div id="articles-container" class="articles-container">
        <p>Chargement des articles...</p>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>Ce site est simplement une maquette pour servir d'exemple à un projet</p>
  </footer>

  <script>
    async function chargerArticles() {
      const container = document.getElementById("articles-container");
      container.innerHTML = "<p>Chargement des articles...</p>";

      try {
        const res = await fetch("liste_article.json");
        const data = await res.json();

        container.innerHTML = "";

        if (!data.articles || data.articles.length === 0) {
          container.innerHTML = "<p class='no-article'>Aucun article disponible</p>";
          return;
        }

        // Charger tous les articles
        const articlesWithData = [];
        for (const chemin of data.articles) {
          try {
            const resArticle = await fetch(chemin);
            const article = await resArticle.json();
            articlesWithData.push(article);
          } catch (err) {
            console.error("Erreur chargement article:", chemin, err);
          }
        }

        // Trier par date décroissante
        articlesWithData.sort((a, b) => new Date(b.date) - new Date(a.date));

        // Créer les cartes pour tous les articles
        for (const article of articlesWithData) {
          const card = document.createElement("div");
          card.classList.add("card");

          if (article.image) {
            const img = document.createElement("img");
            img.src = article.image;
            img.alt = article.titre;
            card.appendChild(img);
          }

          const title = document.createElement("h3");
          title.textContent = article.titre;
          card.appendChild(title);

          const text = document.createElement("p");
          text.textContent = article.texte;
          card.appendChild(text);

          const link = document.createElement("a");
          link.href = article.lien;
          link.textContent = "Lire la suite";
          card.appendChild(link);

          container.appendChild(card);
        }

      } catch (err) {
        container.innerHTML = "<p class='no-article'>Impossible de charger les articles</p>";
        console.error(err);
      }
    }

    chargerArticles();
  </script>
</body>

</html>

