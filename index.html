<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accueil BDE Fun</title>
  <link rel="stylesheet" href="style.css">
  <!-- Privacy-friendly analytics by Plausible -->
  <script async src="https://plausible.io/js/pa-jUQzIwoquetz2aXjRjVbA.js"></script>
  <script>
    window.plausible=window.plausible||function(){(plausible.q=plausible.q||[]).push(arguments)},plausible.init=plausible.init||function(i){plausible.o=i||{}};
    plausible.init()
  </script>
</head>
<body>
  <!-- Header -->
  <header>
    <h1>BDE</h1>
    <nav>
      <ul>
        <li><a href="index.html">Accueil</a></li>
        <li><a href="articles.html">Articles</a></li>
        <li><a href="cabrinibook.html">Cabrinibook</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>
  </header>

  <!-- Section principale -->
  <main>
    <!-- Présentation -->
    <section class="presentation">
      <h2>Bienvenue sur le site du Bureau des Élèves</h2>
      <p>
        Le <strong>BDE</strong> (Bureau des Élèves) est composé d’un groupe d’élèves de terminale 
        motivés et volontaires, qui ont pour mission d’animer la vie lycéenne et de proposer 
        différents projets tout au long de l’année.
      </p>
    
      <h3>Le bal de fin d’année</h3>
      <p>
        L’un des moments forts de leur mission est l’organisation du <strong>bal de fin d’année</strong>.  
        Les élèves du BDE proposent plusieurs thématiques, soumises ensuite au vote de 
        l’ensemble des terminales. Ils s’occupent ensuite de toute l’organisation : 
        la décoration, les animations, et bien sûr le financement.
      </p>
    
      <h3>Des projets variés</h3>
      <p>
        Mais le BDE ne se limite pas au bal !  
        De nombreux projets sont également prévus, qu’ils soient destinés à financer les 
        événements ou simplement à offrir des moments de convivialité aux élèves. 
      </p>
      <p>
        Leurs initiatives sont nombreuses et reflètent leur créativité. 
        <strong>Et si vous avez des idées, n’hésitez pas à les partager avec eux !</strong>
      </p>
    </section>

    <!-- Articles récents -->
    <section class="articles">
      <h2>Derniers Articles</h2>
      <div id="articles-container" class="articles-container">
        <p>Chargement des articles...</p>
      </div>
      <div class="button-container">
        <a href="articles.html" class="btn">Voir plus d’articles</a>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>Ce site est simplement une maquette pour servir d'exemple à un projet</p>
  </footer>

  <!-- Script pour charger les 3 derniers articles -->
  <script>
    async function chargerArticlesRecents() {
      const container = document.getElementById("articles-container");
      container.innerHTML = "<p>Chargement des articles...</p>";

      try {
        const res = await fetch("liste_article.json");
        const data = await res.json();

        container.innerHTML = "";

        if (!data.articles || data.articles.length === 0) {
          container.innerHTML = "<p class='no-article'>Aucun article disponible</p>";
          return;
        }

        // Charger tous les articles
        const articlesWithData = [];
        for (const chemin of data.articles) {
          try {
            const resArticle = await fetch(chemin);
            const article = await resArticle.json();
            articlesWithData.push(article);
          } catch (err) {
            console.error("Erreur chargement article:", chemin, err);
          }
        }

        // Trier par date décroissante
        articlesWithData.sort((a, b) => new Date(b.date) - new Date(a.date));

        // Garder uniquement les 3 derniers articles
        const derniersArticles = articlesWithData.slice(0, 3);

        // Créer les cartes
        for (const article of derniersArticles) {
          const card = document.createElement("div");
          card.classList.add("card");

          if (article.image) {
            const img = document.createElement("img");
            img.src = article.image;
            img.alt = article.titre;
            card.appendChild(img);
          }

          const title = document.createElement("h3");
          title.textContent = article.titre;
          card.appendChild(title);

          const text = document.createElement("p");
          text.textContent = article.texte;
          card.appendChild(text);

          const link = document.createElement("a");
          link.href = article.lien;
          link.textContent = "Lire la suite";
          card.appendChild(link);

          container.appendChild(card);
        }

      } catch (err) {
        container.innerHTML = "<p class='no-article'>Impossible de charger les articles</p>";
        console.error(err);
      }
    }

    chargerArticlesRecents();
  </script>
</body>
</html>
